<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Burbujas Limpias</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            /* Fondo degradado suave estilo cielo/mar */
            background: linear-gradient(to bottom, #00c6ff, #0072ff);
            height: 100vh;
            cursor: pointer;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>

<canvas id="bubbleCanvas"></canvas>

<script>
const canvas = document.getElementById('bubbleCanvas');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let bubbles = [];

class Bubble {
    constructor() {
        this.radius = Math.random() * 35 + 15; // Tamaño variado
        this.x = Math.random() * canvas.width;
        this.y = canvas.height + this.radius;
        this.speedY = Math.random() * 2 + 1;
        this.oscillationSpeed = Math.random() * 0.05 + 0.02;
        this.angle = Math.random() * Math.PI * 2;
        this.opacity = 1;
        
        // Estado de explosión
        this.isPopping = false;
        this.popSpeed = 0;
    }

    draw() {
        if (this.opacity <= 0) return;

        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);

        // Estilo de la burbuja (transparente con borde blanco sutil)
        ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity * 0.15})`;
        ctx.strokeStyle = `rgba(255, 255, 255, ${this.opacity * 0.8})`;
        ctx.lineWidth = 2;
        
        ctx.fill();
        ctx.stroke();

        // Reflejo blanco (el brillo característico)
        if (!this.isPopping) {
            ctx.beginPath();
            ctx.arc(this.x - this.radius * 0.3, this.y - this.radius * 0.3, this.radius * 0.15, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`;
            ctx.fill();
        }
    }

    update() {
        if (this.isPopping) {
            // Animación de estallido: Crece rápido y se hace transparente
            this.radius += 2; // Expansión rápida
            this.opacity -= 0.1; // Desvanecimiento rápido
            this.popSpeed += 0.5;
        } else {
            // Movimiento normal flotando hacia arriba
            this.y -= this.speedY;
            this.x += Math.sin(this.angle) * 1.5; // Oscilación suave
            this.angle += this.oscillationSpeed;
        }
    }
}

function handleBubbles() {
    // Generar burbujas aleatoriamente
    if (Math.random() < 0.04) {
        bubbles.push(new Bubble());
    }

    for (let i = bubbles.length - 1; i >= 0; i--) {
        bubbles[i].update();
        bubbles[i].draw();

        // Eliminar burbujas que ya explotaron totalmente o salieron de la pantalla
        if (bubbles[i].opacity <= 0 || bubbles[i].y + bubbles[i].radius < 0) {
            bubbles.splice(i, 1);
        }
    }
}

// Detectar clic o toque
canvas.addEventListener('mousedown', (e) => {
    const rect = canvas.getBoundingClientRect();
    const mouseX = e.clientX - rect.left;
    const mouseY = e.clientY - rect.top;

    bubbles.forEach(bubble => {
        if (!bubble.isPopping) { // Si ya está explotando, ignorar
            const dx = mouseX - bubble.x;
            const dy = mouseY - bubble.y;
            const distance = Math.sqrt(dx * dx + dy * dy);

            // Si el clic está dentro de la burbuja
            if (distance < bubble.radius) {
                bubble.isPopping = true; // Activar animación de muerte
            }
        }
    });
});

function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    handleBubbles();
    requestAnimationFrame(animate);
}

// Ajustar tamaño si cambia la ventana
window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
});

animate();
</script>

</body>
</html>
